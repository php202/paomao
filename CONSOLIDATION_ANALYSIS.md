# 僅 push 專案整併分析

## 一、目前「無網頁部署」的專案

| 專案 | 綁定試算表 | 觸發方式 | 依賴 |
|------|------------|----------|------|
| **日報表 產出** | 泡泡貓日報表 | 選單 + (可選) URL | Core API |
| **每週三：顧客退費** | 顧客退費表單 | 選單 | Core API |
| **泡泡貓拉廣告資料** | 預約清單（動態） | 選單 | Core API |
| **請款表單內容** | 請款表 | 選單 | Core API |

---

## 二、整併限制：試算表綁定

GAS 專案若需「選單」（onOpen），必須**綁定**到該試算表。**一個專案只能綁定一個試算表**。

因此：
- **請款表單內容**（綁定 請款表）
- **每週三：顧客退費**（綁定 顧客退費表單）
- **泡泡貓拉廣告資料**（綁定 預約清單）

這三個**無法合併成一個專案**，因為各自綁定不同試算表。

---

## 三、可行整併：日報表 產出 → PaoMao_Core

**日報表 產出** 有 doGet/doPost，邏輯可改為 Core 的 `action=runDailyReport`。

| 步驟 | 說明 |
|------|------|
| 1 | 在 PaoMao_Core 新增 `action=runDailyReport`，把 `runAccNeed()` 邏輯移入 |
| 2 | 日報表 產出 專案改為「最小觸發器」：只保留 onOpen + 選單，選單點擊時呼叫 Core API |
| 3 | 若有排程或外部 URL 觸發日報，改為呼叫 Core 的 `?action=runDailyReport` |

**效益**：日報表 產出 專案程式碼大幅減少，核心邏輯集中於 Core。

---

## 四、其餘三專案：維持現狀或輕量化

**每週三、泡泡貓拉廣告、請款表單** 因試算表綁定，專案數量無法減少。但已透過 Core API 取得資料，邏輯已相對精簡。

若未來有「可 API 化」的流程（例如退費、產出 Excel），可考慮在 Core 新增對應 action，專案改為呼叫 Core API，進一步縮小專案體積。

---

## 五、建議操作順序

1. **優先**：日報表 產出 → Core 整併（效益最大）
2. **其餘**：維持現狀，必要時再評估個別流程 API 化
