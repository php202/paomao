# 泡泡貓拉廣告資料 － 使用說明

## 外部人士如何跑這個資料？

目前程式是**綁在試算表上的**（用功能表觸發），外部人士要跑資料，請依下列方式處理。

### 方式一：分享試算表（建議）

1. **管理員**在 Google 試算表裡，對「泡泡貓拉廣告資料」這份試算表：
   - 點 **共用** → 新增**外部人士的 Google 帳號**（Email）
   - 權限設為 **「編輯者」**（至少要能執行指令碼；僅「檢視者」無法跑功能表）

2. **外部人士**：
   - 用收到的連結或邀請開啟試算表
   - 點選功能表 **🛠 分析幫手**
   - 選 **🚀 取得今日預約** 或 **🚀 產出動態預約**
   - **首次執行**時，Google 會要求授權（允許應用程式存取）→ 點「允許」即可

3. 跑完後，資料會寫入試算表內的工作表：
   - **今日建立（動態）**：今日預約筆數（依門市）
   - **預約清單（動態）**：依 A2、B2 的日期範圍產出預約／新舊客等資料

---

### 方式二：改由 Web App（API）觸發（選用）

若希望**不開試算表**也能跑（例如用網址或排程呼叫），需要：

1. 在專案中設定**試算表 ID**（目前程式用「使用中試算表」，Web App 沒有使用中試算表，必須改為用 ID 開啟）。
2. 新增 **doGet(e)**，用 `?key=密鑰&action=todayReservation` 或 `action=appointmentLists` 觸發對應功能。
3. 部署為**網路應用程式**，把網址與密鑰提供給外部人士或排程工具。

若有需要，可再擴充上述 doGet 與試算表 ID 設定。

---

### 注意事項（改為 Core 中央 API）

本專案改為透過 **PaoMao_Core 中央 API**（網路應用程式部署）取得資料。

1. **PaoMao_Core 專案**需先部署為「網路應用程式」（執行 CoreWebApp.js 的 doGet/doPost），並在指令碼屬性設定 **PAO_CAT_SECRET_KEY**。
2. **泡泡貓拉廣告資料 專案**指令碼屬性需設定：
   - **PAO_CAT_CORE_API_URL**：PaoMao_Core「網路應用程式」部署的網址（結尾 /exec，見 DEPLOY.md）
   - **PAO_CAT_SECRET_KEY**：與 PaoMao_Core 相同的密鑰

設定完成後，功能表「取得今日預約」「產出動態預約」會透過 API 取得店家與預約資料，無需對 Core 專案有讀取權限。
